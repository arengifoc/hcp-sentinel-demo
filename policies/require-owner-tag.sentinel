import "tfplan/v2" as tfplan
import "strings"

# Revisa recursos nuevos o cambiados con tags
changed = tfplan.resources.changes

has_owner = func(tags) {
  return tags contains "Owner" and strings.trim_space(tags["Owner"]) != ""
}

main = rule {
  all changed as _, r {
    # Solo aplica a recursos que soportan tags
    if "tags" in r.after {
      has_owner(r.after.tags)
    } else {
      true  # Recursos sin soporte de tags pasan
    }
  }
}
